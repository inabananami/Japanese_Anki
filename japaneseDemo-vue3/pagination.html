<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分页查询</title>
</head>
<body>
    <h1>分页查询</h1>
    <table border="1">
        <thead>
            <tr>
                <th>日语词汇</th>
                <th>中文翻译</th>
                <th>假名</th>
                <th>类型</th>
                <th>例句</th>
            </tr>
        </thead>
        <tbody id="wordsList">
            <!-- 数据渲染位置 -->
        </tbody>
    </table>

    <div>
        <button onclick="changePage('prev')">上一页</button>
        <button onclick="changePage('next')">下一页</button>
    </div>

    <script>
        let pageNum = 1;  // 当前页码

        // 页面加载时自动获取数据
        window.onload = () => {
            fetchWords(pageNum);  // 自动加载第一页数据
        };

        // 获取数据
        async function fetchWords(pageNum) {
            const token = localStorage.getItem('jwtToken');
            console.log(localStorage.getItem('jwtToken'));
            if (!token) {
                alert("请先登录！");
                window.location.href = 'login.html';  // 未登录跳转到登录页面
                return;
            }

            try {
                const response = await fetch(`http://localhost:8080/word/list?pageNum=${pageNum}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `${token}`,
                        'Content-Type': 'application/json',
                    }
                });

                const data = await response.json();
                if (data.success) {
                    renderWords(data.data);  // 渲染单词列表
                } else {
                    alert("数据加载失败：" + data.msg);
                }
            } catch (error) {
                console.error('获取数据失败:', error);
                alert('请求失败，请稍后再试');
            }
        }

        // 渲染数据
        function renderWords(words) {
            const wordsList = document.getElementById('wordsList');
            wordsList.innerHTML = '';  // 清空之前的内容

            words.forEach(word => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${word.japaneseWord}</td>
                    <td>${word.chineseWord}</td>
                    <td>${word.kana}</td>
                    <td>${word.type}</td>
                    <td>${word.exampleSentence}</td>
                `;
                wordsList.appendChild(row);
            });
        }

        // 翻页功能
        function changePage(direction) {
            if (direction === 'prev' && pageNum > 1) {
                pageNum--;
            } else if (direction === 'next') {
                pageNum++;
            }
            fetchWords(pageNum);  // 获取新的分页数据
        }
    </script>
</body>
</html>
